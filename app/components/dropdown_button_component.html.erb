<div class="relative inline-block text-left" data-controller="dropdown">
  <div>
    <% if hide_chevron_on_mobile %>
      <!-- Mobile: Just triple dots, no background -->
      <button type="button" class="flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none focus:text-gray-600 dark:focus:text-gray-300 p-2 md:hidden"
              data-action="click->dropdown#toggle"
              data-dropdown-target="button"
              aria-expanded="false"
              aria-haspopup="true">
        <span class="sr-only">Open options</span>
        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
          <path d="M10 3a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM10 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM11.5 15.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z" />
        </svg>
      </button>

      <!-- Desktop: Full button with text and chevron -->
      <button type="button" class="<%= button_classes %> !hidden md:!inline-flex"
              data-action="click->dropdown#toggle"
              data-dropdown-target="button"
              aria-expanded="false"
              aria-haspopup="true">
        <%= text %>
        <svg class="<%= chevron_classes %>" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
          <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
        </svg>
      </button>
    <% else %>
      <!-- Standard button -->
      <button type="button" class="<%= button_classes %>"
              data-action="click->dropdown#toggle"
              data-dropdown-target="button"
              aria-expanded="false"
              aria-haspopup="true">
        <%= text %>
        <svg class="<%= chevron_classes %>" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
          <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
        </svg>
      </button>
    <% end %>
  </div>

  <div class="absolute right-0 md:left-auto md:right-0 md:translate-x-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black/5 dark:ring-white/10 focus:outline-hidden opacity-0 scale-95 transition ease-out duration-100 pointer-events-none"
      role="menu"
      aria-orientation="vertical"
      tabindex="-1"
      inert
      data-dropdown-target="menu"
      data-transition-enter="transition ease-out duration-100"
      data-transition-enter-start="transform opacity-0 scale-95"
      data-transition-enter-end="transform opacity-100 scale-100"
      data-transition-leave="transition ease-in duration-75"
      data-transition-leave-start="transform opacity-100 scale-100"
      data-transition-leave-end="transform opacity-0 scale-95">

    <div class="py-1" role="none">
      <% items.each_with_index do |item, item_index| %>
        <%= render_menu_item(item, "menu-item-#{item_index}") %>
      <% end %>
    </div>
  </div>
</div>
